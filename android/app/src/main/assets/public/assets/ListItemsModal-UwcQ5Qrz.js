import{d as T,r as w,a7 as U,a8 as V,o as g,c as C,w as n,b as o,u as t,v as R,x as M,h as x,y as _,z,j as k,H as p,Q as K,A as j,e as q,I as b,i as H,a9 as F,K as P,f as Q,N as X,L as Z,O as G,P as J,k as W,C as Y,Z as ee,aa as D,ab as te,g as ae,ac as le,_ as se,$ as O,a0 as oe,a2 as ne,q as f,t as v,X as I,ad as B}from"./index-BGNe5PAX.js";const ie=T({__name:"ListItemsModal",props:{isOpen:{type:Boolean},list:{}},emits:["update:isOpen","listUpdated"],setup(m,{emit:y}){const i=m,u=y,d=w(""),s=w([]);U(()=>{var e;return(e=i.list)==null?void 0:e.items},e=>{e&&(s.value=[...e])},{deep:!0,immediate:!0});const h=async()=>{if(!i.list||!d.value.trim())return;const e={id:Date.now().toString(),text:d.value.trim(),completed:!1,createdAt:new Date().toISOString()};try{s.value=[...s.value,e],d.value="";const a=f(v,"lists",i.list.id);await I(a,{items:s.value}),u("listUpdated")}catch(a){console.error("Erro ao adicionar item:",a),s.value=s.value.filter(l=>l.id!==e.id)}},L=async e=>{if(i.list)try{const a=s.value.findIndex(r=>r.id===e);if(a===-1)return;const l={...s.value[a],completed:!s.value[a].completed};s.value=s.value.map(r=>r.id===e?l:r);const c=f(v,"lists",i.list.id);await I(c,{items:s.value}),u("listUpdated")}catch(a){console.error("Erro ao atualizar item:",a),i.list&&(s.value=[...i.list.items])}},S=async e=>{await(await B.create({header:"Editar Item",inputs:[{name:"text",type:"text",value:e.text,placeholder:"Nome do item"}],buttons:[{text:"Cancelar",role:"cancel"},{text:"Salvar",handler:async l=>{if(!(!l.text.trim()||!i.list))try{s.value=s.value.map(r=>r.id===e.id?{...r,text:l.text.trim()}:r);const c=f(v,"lists",i.list.id);await I(c,{items:s.value}),u("listUpdated")}catch(c){console.error("Erro ao editar item:",c),s.value=s.value.map(r=>r.id===e.id?e:r)}}}]})).present()},$=async e=>{await(await B.create({header:"Confirmar exclusÃ£o",message:"Deseja realmente excluir este item?",buttons:[{text:"Cancelar",role:"cancel"},{text:"Excluir",role:"destructive",handler:()=>E(e)}]})).present()},E=async e=>{if(i.list)try{s.value=s.value.filter(l=>l.id!==e.id);const a=f(v,"lists",i.list.id);await I(a,{items:s.value}),u("listUpdated")}catch(a){console.error("Erro ao deletar item:",a),i.list&&(s.value=[...i.list.items])}},A=e=>new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),N=V(()=>[...s.value].sort((e,a)=>e.completed!==a.completed?e.completed?1:-1:new Date(a.createdAt).getTime()-new Date(e.createdAt).getTime()));return(e,a)=>(g(),C(t(Y),{"is-open":e.isOpen,onDidDismiss:a[2]||(a[2]=l=>e.$emit("update:isOpen",!1))},{default:n(()=>[o(t(j),null,{default:n(()=>[o(t(R),null,{default:n(()=>[o(t(M),null,{default:n(()=>{var l;return[x(_((l=e.list)==null?void 0:l.name),1)]}),_:1}),o(t(z),{slot:"end"},{default:n(()=>[o(t(k),{onClick:a[0]||(a[0]=l=>e.$emit("update:isOpen",!1))},{default:n(()=>[o(t(p),{icon:t(K)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),o(t(W),{class:"ion-padding"},{default:n(()=>[q("form",{onSubmit:Q(h,["prevent"]),class:"mb-4"},[o(t(b),null,{default:n(()=>[o(t(H),{modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=l=>d.value=l),placeholder:"Adicionar novo item",required:"","clear-input":"",onKeyup:F(h,["enter"])},null,8,["modelValue"]),o(t(k),{type:"submit",slot:"end",disabled:!d.value.trim()},{default:n(()=>[o(t(p),{icon:t(P)},null,8,["icon"])]),_:1},8,["disabled"])]),_:1})],32),o(t(X),null,{default:n(()=>[(g(!0),Z(J,null,G(N.value,l=>(g(),C(t(ee),{key:l.id},{default:n(()=>[o(t(b),{class:D({completed:l.completed})},{default:n(()=>[o(t(te),{checked:l.completed,onIonChange:c=>L(l.id),slot:"start"},null,8,["checked","onIonChange"]),o(t(ae),{class:D({"line-through":l.completed})},{default:n(()=>[x(_(l.text),1)]),_:2},1032,["class"]),o(t(le),{slot:"end",class:"item-date"},{default:n(()=>[x(_(A(l.createdAt)),1)]),_:2},1024)]),_:2},1032,["class"]),o(t(se),{side:"end"},{default:n(()=>[o(t(O),{color:"primary",onClick:c=>S(l)},{default:n(()=>[o(t(p),{icon:t(oe),slot:"icon-only"},null,8,["icon"])]),_:2},1032,["onClick"]),o(t(O),{color:"danger",onClick:c=>$(l)},{default:n(()=>[o(t(p),{icon:t(ne),slot:"icon-only"},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1},8,["is-open"]))}}),re=(m,y)=>{const i=m.__vccOpts||m;for(const[u,d]of y)i[u]=d;return i},ce=re(ie,[["__scopeId","data-v-b140111a"]]);export{ce as L,re as _};
