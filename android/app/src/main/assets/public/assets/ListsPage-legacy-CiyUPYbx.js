System.register(["./index-legacy-CrO6uvyO.js","./ListItemsModal-legacy-BZ5ERIRs.js"],(function(e,a){"use strict";var l,t,i,o,n,r,s,u,c,d,v,p,m,f,g,h,y,_,b,w,k,x,C,U,L,E,P,O,S,I,V,D,N,j,A,M,q,z,B,W,F,J,G,H,K,Q,R,T,X,Y,Z,$,ee,ae,le,te,ie,oe,ne;return{setters:[e=>{l=e.d,t=e.r,i=e.o,o=e.c,n=e.w,r=e.b,s=e.u,u=e.v,c=e.x,d=e.h,v=e.y,p=e.z,m=e.j,f=e.A,g=e.I,h=e.g,y=e.i,_=e.B,b=e.k,w=e.C,k=e.D,x=e.E,C=e.F,U=e.a,L=e.m,E=e.G,P=e.H,O=e.J,S=e.K,I=e.L,V=e.M,D=e.e,N=e.N,j=e.O,A=e.P,M=e.Q,q=e.R,z=e.l,B=e.S,W=e.T,F=e.t,J=e.U,G=e.V,H=e.W,K=e.X,Q=e.q,R=e.Y,T=e.Z,X=e._,Y=e.$,Z=e.a0,$=e.a1,ee=e.a2,ae=e.a3,le=e.a4,te=e.a5,ie=e.a6},e=>{oe=e.L,ne=e._}],execute:function(){var a=document.createElement("style");a.textContent=".debug-overlay[data-v-1c927c1b]{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.8);z-index:1000;display:flex;justify-content:center;align-items:center}.debug-content[data-v-1c927c1b]{background-color:#1e1e1e;border-radius:8px;padding:20px;width:90%;max-width:600px;max-height:80vh;overflow-y:auto;position:relative}.close-button[data-v-1c927c1b]{position:absolute;top:10px;right:10px}.debug-text[data-v-1c927c1b]{font-family:monospace;font-size:12px;color:#fff;white-space:pre-wrap;word-wrap:break-word}\n",document.head.appendChild(a);const re=l({__name:"ListEditModal",props:{isOpen:{type:Boolean},initialName:{},initialPublic:{type:Boolean},mode:{}},emits:["update:isOpen","save"],setup(e,{emit:a}){const l=e,k=a,x=t(l.initialName||""),C=t(l.initialPublic||!1),U=()=>{k("update:isOpen",!1)},L=()=>{k("save",{name:x.value,isPublic:C.value}),U()};return(e,a)=>(i(),o(s(w),{"is-open":e.isOpen,onDidDismiss:U},{default:n((()=>[r(s(f),null,{default:n((()=>[r(s(u),null,{default:n((()=>[r(s(c),null,{default:n((()=>[d(v("create"===e.mode?"Nova Lista":"Editar Lista"),1)])),_:1}),r(s(p),{slot:"end"},{default:n((()=>[r(s(m),{onClick:U},{default:n((()=>a[2]||(a[2]=[d("Fechar")]))),_:1})])),_:1})])),_:1})])),_:1}),r(s(b),{class:"ion-padding"},{default:n((()=>[r(s(g),null,{default:n((()=>[r(s(h),{position:"stacked"},{default:n((()=>a[3]||(a[3]=[d("Nome da Lista")]))),_:1}),r(s(y),{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value=e),placeholder:"Digite o nome da lista",required:""},null,8,["modelValue"])])),_:1}),r(s(g),null,{default:n((()=>[r(s(h),null,{default:n((()=>a[4]||(a[4]=[d("Lista Pública")]))),_:1}),r(s(_),{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=e=>C.value=e)},null,8,["modelValue"])])),_:1}),r(s(m),{expand:"block",class:"ion-margin-top",onClick:L,disabled:!x.value},{default:n((()=>[d(v("create"===e.mode?"Criar":"Salvar"),1)])),_:1},8,["disabled"])])),_:1})])),_:1},8,["is-open"]))}}),se={key:0,class:"flex justify-center items-center h-full"},ue={key:1,class:"p-4 text-center"},ce={class:"flex items-center"},de={key:3,class:"debug-overlay"},ve={class:"debug-content"},pe={class:"debug-text"};e("default",ne(l({__name:"ListsPage",setup(e){const a=t([]),l=t(!0),y=t(null);t(!1);const _=U(),w=async()=>{if(L.currentUser)try{l.value=!0,y.value&&y.value();const e=B(W(F,"lists"),J("ownerId","==",L.currentUser.uid)),t=G(e,(e=>{a.value=e.docs.map((e=>({id:e.id,...e.data()}))),l.value=!1}),(e=>{console.error("Erro ao carregar listas:",e),l.value=!1}));y.value=t}catch(e){console.error("Erro ao configurar listener:",e),l.value=!1}};k((()=>{const e=x(L,(e=>{e?w():_.push("/login")}));C((()=>{e(),y.value&&y.value()}))}));const ne=t(!1),me=t(null),fe=t("create"),ge=()=>{me.value=null,fe.value="create",ne.value=!0},he=async e=>{if(!L.currentUser)return console.error("Usuário não autenticado"),void alert("Você precisa estar autenticado para criar listas");try{if("create"===fe.value){const a={name:e.name,isPublic:e.isPublic,ownerId:L.currentUser.uid,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),items:[]};await H(W(F,"lists"),a),ne.value=!1}else{if(!me.value)throw new Error("Nenhuma lista selecionada para edição");const a={name:e.name,isPublic:e.isPublic,updatedAt:(new Date).toISOString()};await K(Q(F,"lists",me.value.id),a),ne.value=!1}}catch(a){console.error("Erro ao salvar lista:",a),alert("Erro ao salvar lista. Por favor, tente novamente.")}},ye=t(!1),_e=async()=>{if(ye.value=!ye.value,L.currentUser){console.log("Auth state:",{uid:L.currentUser.uid,email:L.currentUser.email});try{const e=W(F,"lists"),a=B(e,J("ownerId","==",L.currentUser.uid)),l=await R(a);console.log("Lists:",l.docs.map((e=>({id:e.id,...e.data()}))))}catch(e){console.error("Erro ao carregar listas:",e)}}else console.log("Usuário não autenticado")},be=t(!1);return(e,t)=>{const y=E("ion-badge");return i(),o(s(z),null,{default:n((()=>{var e,_;return[r(s(f),null,{default:n((()=>[r(s(u),null,{default:n((()=>[r(s(c),null,{default:n((()=>t[3]||(t[3]=[d("Minhas Listas")]))),_:1}),r(s(p),{slot:"end"},{default:n((()=>[r(s(m),{onClick:_e},{default:n((()=>[r(s(P),{icon:s(O)},null,8,["icon"])])),_:1}),r(s(m),{onClick:ge},{default:n((()=>[r(s(P),{icon:s(S)},null,8,["icon"])])),_:1})])),_:1})])),_:1})])),_:1}),r(s(b),{fullscreen:!0},{default:n((()=>{var e;return[l.value?(i(),I("div",se,[r(s(V))])):0===a.value.length?(i(),I("div",ue,t[4]||(t[4]=[D("p",null,"Nenhuma lista encontrada",-1),D("p",{class:"text-sm text-gray-500"},"Clique no + para criar uma nova lista",-1)]))):(i(),o(s(N),{key:2},{default:n((()=>[(i(!0),I(A,null,j(a.value,(e=>(i(),o(s(T),{key:e.id},{default:n((()=>[r(s(g),{onClick:a=>(e=>{me.value=e,be.value=!0})(e)},{default:n((()=>[r(s(h),null,{default:n((()=>{var a;return[D("div",ce,[D("h2",null,v(e.name),1),e.isOwner?q("",!0):(i(),o(y,{key:0,color:"tertiary",class:"ml-2"},{default:n((()=>t[5]||(t[5]=[d("Compartilhada")]))),_:1}))]),D("p",null,v((null===(a=e.items)||void 0===a?void 0:a.length)||0)+" items",1)]})),_:2},1024)])),_:2},1032,["onClick"]),r(s(X),null,{default:n((()=>[r(s(Y),{color:"warning",onClick:a=>(e=>{me.value=e,fe.value="edit",ne.value=!0})(e)},{default:n((()=>[r(s(P),{icon:s(Z),slot:"icon-only"},null,8,["icon"])])),_:2},1032,["onClick"]),r(s(Y),{color:"primary",onClick:a=>(async e=>{try{var a;const l=prompt("Digite o email para compartilhar:");if(!l)return;const t=W(F,"users"),i=B(t,J("email","==",l),ae(1)),o=await R(i);if(o.empty)return void alert("Usuário não encontrado");const n=o.docs[0].id,r=Q(F,"lists",e),s=await le(r);if(!s.exists())return void alert("Lista não encontrada");const u=s.data();if(u.ownerId!==(null===(a=L.currentUser)||void 0===a?void 0:a.uid))return void alert("Você não tem permissão para compartilhar esta lista");if((u.sharedWith||[]).includes(n))return void alert("Lista já compartilhada com este usuário");await K(r,{sharedWith:te(n)}),alert("Lista compartilhada com sucesso!")}catch(l){console.error("Erro ao compartilhar lista:",l),alert("Erro ao compartilhar lista. Por favor, tente novamente.")}})(e.id)},{default:n((()=>[r(s(P),{icon:s($),slot:"icon-only"},null,8,["icon"])])),_:2},1032,["onClick"]),r(s(Y),{color:"danger",onClick:l=>(async e=>{try{await ie(Q(F,"lists",e)),a.value=a.value.filter((a=>a.id!==e))}catch(l){console.error("Erro ao deletar lista:",l)}})(e.id)},{default:n((()=>[r(s(P),{icon:s(ee),slot:"icon-only"},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})),ye.value?(i(),I("div",de,[D("div",ve,[r(s(m),{fill:"clear",onClick:t[0]||(t[0]=e=>ye.value=!1),class:"close-button"},{default:n((()=>[r(s(P),{icon:s(M)},null,8,["icon"])])),_:1}),D("pre",pe,"Auth: "+v(null===(e=s(L).currentUser)||void 0===e?void 0:e.uid)+"\nLists: "+v(JSON.stringify(a.value,null,2))+"\n          ",1)])])):q("",!0)]})),_:1}),r(re,{"is-open":ne.value,"onUpdate:isOpen":t[1]||(t[1]=e=>ne.value=e),"initial-name":null===(e=me.value)||void 0===e?void 0:e.name,"initial-public":null===(_=me.value)||void 0===_?void 0:_.isPublic,mode:fe.value,onSave:he},null,8,["is-open","initial-name","initial-public","mode"]),r(oe,{"is-open":be.value,"onUpdate:isOpen":t[2]||(t[2]=e=>be.value=e),list:me.value,onListUpdated:w},null,8,["is-open","list"])]})),_:1})}}}),[["__scopeId","data-v-1c927c1b"]]))}}}));
